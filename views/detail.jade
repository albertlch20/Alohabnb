extends layout2

block content
  div(id='content' class='p-4 p-md-5 pt-5')
    div(id='container' class='container')
      p#showRes.hidden Success
      div(class='main' style='width:70rem')
        div(id='#{pid}' class='carousel slide mx-auto card-img-top' data-interval='false')
          .row
            .col-lg-4.col-md-12.mb-4.mb-lg-0
              img.w-100.shadow-1-strong.rounded.mb-4(src='/#{images[0]}')
            .col-lg-4.mb-4.mb-lg-0
              img.w-100.shadow-1-strong.rounded.mb-4(src='/#{images[1]}')
            .col-lg-4.mb-4.mb-lg-4
              img.w-100.shadow-1-strong.rounded.mb-4(src='/#{images[2]}')

        div(class='card-body')
          h5 #{title}
          p(class='card-text') #{location}
        br
        div(class='body')
          div(class='main' style='width:30rem')
            table(class='table')
              tbody
                tr
                  th(scope='row') Bedrooms: 
                  td #{bedrooms}
                tr
                  th(scope='row') Nightly Fees: 
                  td #{nightly_fee}
                tr
                  th(scope='row') Cleaning Fee: 
                  td #{cleaning_fee}
                tr
                  th(scope='row') Service Fee: 
                  td #{service_fee}
                tr
                  th(scope='row') Description: 
                  td #{description}
                tr
                  th(scope='row') Amenities: 
                  td #{amenities}
            div(class='form-group')
              //label(htmlfor='exampleFormControlTextarea1') Add Comment
              //textarea#exampleFormControlTextarea1(class='form-control' rows='3')
            .input-group
              //button.btn.btn-primary.m-2(type='submit' onclick='{returnToMainPage}') Submit
              form(action="/users/favourites" method='POST')
                input#uid.btn.btn-primary.m-2(name='uid' type='hidden' value='')
                input#pid.btn.btn-primary.m-2(name='pid' type='hidden' value='#{pid}')
                input.btn.btn-primary.m-2(type='submit' value='Add to Favourites')
              form(action="/newReservation/#{pid}")
                input.btn.btn-primary.m-2(type='submit' value='Reserve')
            //// comment
            div(classname='form-group')
              label(htmlfor='commentForm') Add Comment
              ////comment submit
            form(action="/properties/comments" method='POST')
              textarea#text(name='text' classname='form-control' rows='3')
              input#uid.btn.btn-primary.m-2(name='uid' type='hidden' value='#{uid}')
              input#pid.btn.btn-primary.m-2(name='pid' type='hidden' value='#{pid}')
              input.btn.btn-primary.m-2(type='submit' value='Post Comment')
            ////section#wrapper
              aside.card.w-100
            br
            table.table
              thead
                tr
                th uid
                th Date
                th Rating
                th Comments
                th
              tbody
                each review in reviews
                  tr
                    td= review.uid
                    td= review.date
                    td= review.rating
                    td= review.text
                    td
                      button(value=reviews.uid, class='hidden', type='submit', ) Cancel

            ///

            ///
            script.
              const user = JSON.parse(localStorage.getItem('user'));

              if(user) {
                var uid = document.getElementById("uid");
                uid.value = user.uid;
              } else {
                window.location.href = "/login";
                alert('Please log in first!');
              }

              $(document).ready(function() {
                if('#{updateResult}' !== '') {
                  showRes.textContent='#{updateResult}';
                  showRes.classList.remove('hidden');
                }
              })
              function getText() {
                var text = document.getElementById("userInput").value;
                alert(text);
              }
